{% extends "base.html" %}

{% block content %}

<div class="container row mt-3">
    <div class="col-md-8">
        <h3 class="my-text">{{students.count}} STUDENT{{students|pluralize:'S'}}:</h3>
    </div>
    <div class="col-md-4">
        <a class="btn bg-banner text-white border p-2 w-100" href="{% url "add_student" %}">Add Student</a>
    </div>
</div>

<div class=" mt-3">
    <div class='container text-center pb-3'>
        <form id="searchForm" action="" method='get'>
            <div class="input-group w-75 m-auto">
                <input type="text" class="form-control p-2" placeholder="Search By Student Name | Phone Number | School | Class" aria-label="Recipient's username" aria-describedby="button-addon2" name='search_query' value="{{ search_query }}">
                <button class="btn bg-banner text-white border" type="submit" id="button-addon2">Search</button>
            </div>
        </form> 
    </div>
</div>

<div class="container table-responsive ">
    <table class="table table-success table-hover ">
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Name</th>
            <th scope="col">Phone</th>
            <th scope="col">Class</th>
            <th scope="col">School</th>
            <th scope="col">Subject</th>
            <th scope="col">Payment Status</th>
            <th scope="col">Action</th>
          </tr>
        </thead>
        <tbody>
            {% for student in students %}
            <tr>
                <th scope="row">{{student.id}}</th>
                <td>{{student.user.first_name}} {{student.user.last_name}}</td>
                <td>{{student.phone}}</td>
                <td>{{student.current_class}}</td>
                <td>{{student.school.name}}</td>
                <td>
                    {% for subject in student.subjects.all %}
                        {{ subject.name }}{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                </td>
                <td>
                    {% if student.payment_due_month_count > 0 %}
                        <span class="text-danger fw-bold">{{ student.payment_due_month_count }} Month{{ student.payment_due_month_count|pluralize }} Due</span>
                    {% else %}
                        <span class="text-success fw-bold">All Paid</span>
                    {% endif %}
                </td>
                <td><a href="{% url "student_details" student.id %}" class="btn btn-warning ">View</a></td>
            </tr>
            {% endfor %}
        </tbody>
      </table>
</div>

{% endblock content %}